# Testing

## Local Testing

### Lint

To ensure that your changes are consistent with the project coding style, run `npm run lint`.
This checks the repository against a variety of [ESLint](https://eslint.org/) rules, including (but not limited to):

-   Consistent spacing and indentation
-   The presence of the NIST license/distribution notice in all source files
-   Anti-patterns such as unused symbols

Some issues can be fixed automatically by running `npm run lint-fix`.

The linter is invoked by GitHub Actions when a pull request is run via the [Lint and Test workflow](./.github/workflows/test.yaml).
Lint checks must pass before a pull request can be merged.

### Test

Tests can be found along source code in files with the `.spec.` infix.
To run all unit tests, run `npm run test`.
A test coverage report can be generated by running `npm run coverage`.
This project uses [Mocha](https://mochajs.org/) to run tests, and [Istanbul (NYC)](https://istanbul.js.org/) to generate coverage reports.

These tests are run by GitHub Actions when a pull request is run via the [Lint and Test workflow](./.github/workflows/test.yaml).
Tests must pass before a pull request can be merged.

## CI/CD

### Testing and Evaluation

**SA-11: Developer Security Testing And Evaluation**

The NIST ITL CSD developers that maintain the `oscal-deep-diff` application system at all post-design stages of the system development life cycle:

- Perform unit and integration testing/evaluation for every commit in a development branch submitted for code review in the form of a pull request sent to the development team before merging it to the main release branch at the development team's recommended level of depth and coverage as described in [the code coverage tool's configuration file](./.nyrc);
- Produce evidence of the execution of the assessment plan and the results of the testing and evaluation;
- Implement a verifiable flaw remediation process;
- Correct flaws identified during testing and evaluation
The required coverage is defined in this repository by the config file [`.nycrc`](./.nycrc).

This check is performed by GitHub actions via the [Lint and Test workflow](./.github/workflows/test.yaml) for all pull requests.

### Static Code Analysis

In accordance with **SA-11(1): Static Code Analysis**, this repository uses static code analysis to:

-   Check pull requests against common anti-patterns and potential flaws before they are allowed to be merged.
-   Periodically check the current state of the repository for flaws and vulnerabilities.

This check is performed by GitHub Actions via the [CodeQL Analysis workflow](./.github/workflows/codeql-analysis.yaml) as well as the linting portion of the [Lint and Test workflow](./.github/workflows/test.yaml).

### Vulnerability Analysis

In accordance with **SA-11(2): Threat and Vulnerability Analyses**, this repository uses [Dependabot](https://github.com/dependabot) to monitor for vulnerabilities in dependencies.

### Manual Code Reviews

In accordance with **SA-11(4): Manual Code Reviews**, this repository requires manual code reviews from members of the OSCAL team for a pull request to be merged.
The protection rules can be verified by checking the [CODEOWNERS](./.github/CODEOWNERS) file.
